all_years
all_years()
ftrs_src_snk_year  %>% ggplot(aes(DateAcquired, Price, colour = factor(year(StartDate)))) + geom_point(aes(alpha = 10 / (year(StartDate) - 2013))
)
ftrs_src_snk_year  %>% ggplot(aes(DateAcquired, Price, colour = factor(year(StartDate)))) + geom_point( aes(alpha = (10 / (year(StartDate) - 2013)))
)
ftrs_src_snk_year  %>% ggplot(aes(DateAcquired, Price, colour = factor(year(StartDate)))) + geom_point()
all_years()
ftrs_src_snk_year 
ftrs_src_snk_year  %>% filter(StartDate >= ymd(20160101))
ftrs_src_snk_year  %>% filter(StartDate >= ymd(20160101)) %>% 
    ggplot(aes(DateAcquired, Price, colour = factor(year(StartDate)))) +
      geom_point() +
      geom_line(data = final_node_price_differences, aes(x = trading_month, y = price_sink_source_aggr), colour = "black")
  ftrs_src_snk_year  <- ftrs %>% filter(Source == source_node & Sink == sink_node)
  final_src_snk_year <- final_prices %>% filter(Node %in% c(source_node_poc, sink_node_poc))
  final_node_price_differences <- create_final_node_price_differences(final_src_snk_year)
ftrs_src_snk_year  %>% ggplot(aes(DateAcquired, Price, colour = factor(year(StartDate)))) + geom_point( aes(alpha = (10 / (year(StartDate) - 2013)))
)
source("ftr.R")
ls()
run()
source("ftr.R")
ls()
ls_data()
run()
ls_data()
plot_scaled()
source("ftr.R") ; run()
plot_ftrs()
all_yers()
all_yeras()
all_years()
library(shiny) ; runApp()
source("ftr.R")
run()
ls_fns()
all_years()
compare_years()
compare_years <- function() {
  ftr_year <- 2019
  run()
  final_node_price_differences_1 <- final_node_price_differences
  p1 <- final_node_price_differences_1 %>%
          filter(trading_month > ymd(20180101)) %>%
          ggplot(aes(x = trading_month, y = price_sink_source_aggr)) +
            geom_line()  +
            geom_line(data = ftrs_src_snk_year, aes(DateAcquired, Price, colour = factor(StartDate)))
  ftr_year <- 2020
  run()
  p2 <- final_node_price_differences %>%
          filter(trading_month > ymd(20180101)) %>%
          ggplot(aes(x = trading_month, y = price_sink_source_aggr)) +
            geom_line() +
            geom_line(data = ftrs_src_snk_year, aes(DateAcquired, Price, colour = factor(StartDate)))
  p1 + p2
}
compare_years()
compare_years <- function() {
  ftr_year <- 2019
  run()
  final_node_price_differences_1 <- final_node_price_differences
  p1 <- final_node_price_differences_1 %>%
          filter(trading_month > ymd(20180101)) %>%
          ggplot(aes(x = trading_month, y = price_sink_source_aggr)) +
            geom_line()  +
            geom_line(data = ftrs_src_snk_year, aes(DateAcquired, Price, colour = factor(StartDate)))
  p1
  #ftr_year <- 2020
  #run()
  #p2 <- final_node_price_differences %>%
          #filter(trading_month > ymd(20180101)) %>%
          #ggplot(aes(x = trading_month, y = price_sink_source_aggr)) +
            geom_line() +
            #geom_line(data = ftrs_src_snk_year, aes(DateAcquired, Price, colour = factor(StartDate)))
#
  #p1 + p2
}
compare_years <- function() {
  ftr_year <- 2019
  run()
  final_node_price_differences_1 <- final_node_price_differences
  p1 <- final_node_price_differences_1 %>%
          filter(trading_month > ymd(20180101)) %>%
          ggplot(aes(x = trading_month, y = price_sink_source_aggr)) +
            geom_line()  +
            geom_line(data = ftrs_src_snk_year, aes(DateAcquired, Price, colour = factor(StartDate)))
  p1
  #ftr_year <- 2020
  #run()
  #p2 <- final_node_price_differences %>%
          #filter(trading_month > ymd(20180101)) %>%
          #ggplot(aes(x = trading_month, y = price_sink_source_aggr)) +
            #geom_line() +
            #geom_line(data = ftrs_src_snk_year, aes(DateAcquired, Price, colour = factor(StartDate)))
#
  #p1 + p2
}
compare_years()
compare_years <- function() {
  ftr_year <<- 2019
  run()
  p1 <- final_node_price_differences %>%
          filter(trading_month > ymd(20180101)) %>%
          ggplot(aes(x = trading_month, y = price_sink_source_aggr)) +
            geom_line()  +
            geom_line(data = ftrs_src_snk_year, aes(DateAcquired, Price, colour = factor(StartDate)))
  ftr_year <<- 2020
  run()
  p2 <- final_node_price_differences %>%
          filter(trading_month > ymd(20180101)) %>%
          ggplot(aes(x = trading_month, y = price_sink_source_aggr)) +
            geom_line() +
            geom_line(data = ftrs_src_snk_year, aes(DateAcquired, Price, colour = factor(StartDate)))
  p1 + p2
}
compare_years()
ftr_year <- 2018
run()
plot_final()
plot_ftrs()
plot_scaled()
  temp <- ftrs_src_snk_year %>% group_by(DateAcquired, StartDate) %>%
                                summarise(price_aggr = mean(Price)) %>%
                                ungroup
  temp %>%  ggplot(aes(DateAcquired, scale(price_aggr), colour = factor(StartDate))) +
              geom_line(stat = 'smooth', alpha = 0.4, se = FALSE) +
              geom_line(data = temp, aes(DateAcquired, scale(price_aggr)), stat = 'smooth', colour = "black" ) +
              geom_smooth(data = final_node_price_differences, aes(trading_month, scale(price_sink_source_aggr)), colour = "red")
temp
final_node_price_differences
ftr_scaled <- temp %>% mutate(price_scaled = scale(price_aggr)) %>% select(DateAcquired, price_scaled)
ftr_scaled 
final_scaled <- final_node_price_differences %>% mutate(price_scaled = scale(price_sink_source_aggr)) %>% select(trading_month, price_scaled)
final_scaled 
?cor
ftr_scaled  %>% tail
final_scaled  %>% tail
  temp %>%  ggplot(aes(DateAcquired, scale(price_aggr), colour = factor(StartDate))) +
              geom_line(stat = 'smooth', alpha = 0.4, se = FALSE) +
              geom_line(data = temp, aes(DateAcquired, scale(price_aggr)), stat = 'smooth', colour = "black" ) +
              geom_line(data = final_node_price_differences, aes(trading_month, scale(price_sink_source_aggr)), colour = "red")
  temp %>%  ggplot(aes(DateAcquired, scale(price_aggr), colour = factor(StartDate))) +
temp %>% geom_line(aes(DateAcquired, scale(price_aggr)), stat = 'smooth', colour = "black" ) + geom_line(data = final_node_price_differences, aes(trading_month, scale(price_sink_source_aggr)), colour = "red") + theme(legend.title = element_blank())
temp %>% ggplot(aes(DateAcquired, scale(price_aggr)) + geom_line(stat = 'smooth', colour = "black" ) + geom_line(data = final_node_price_differences, aes(trading_month, scale(price_sink_source_aggr)), colour = "red") + theme(legend.title = element_blank())
)
temp %>% ggplot(aes(DateAcquired, scale(price_aggr)) + geom_line(stat = 'smooth', colour = "black" )
temp %>% ggplot(aes(DateAcquired, scale(price_aggr))) + geom_line(stat = 'smooth', colour = "black" )
temp %>% ggplot(aes(DateAcquired, scale(price_aggr))) + geom_line(stat = 'smooth', colour = "black" ) + geom_line(data = final_node_price_differences, aes(trading_month, scale(price_sink_source_aggr)), colour = "red") + theme(legend.title = element_blank())
temp %>% ggplot(aes(DateAcquired, scale(price_aggr))) + geom_line(stat = 'smooth', colour = "black" ) + geom_smooth(data = final_node_price_differences, aes(trading_month, scale(price_sink_source_aggr)), colour = "red") + theme(legend.title = element_blank())
temp %>% ggplot(aes(DateAcquired, scale(price_aggr))) + geom_line(stat = 'smooth', colour = "black" ) + geom_smooth(data = final_node_price_differences, aes(trading_month, scale(price_sink_source_aggr)), colour = "red", se = F) + theme(legend.title = element_blank())
plot_scaled()
getwd()
source("ftr.R")
ls_data()
final_prices
ftrs
final_prices %>% filter(Node %in% ("BEN2201", "OTA2201")) %>% pivot_wider(names_from = "Node", values_from = "Price")
final_prices %>% filter(Node %in% c("BEN2201", "OTA2201")) %>% pivot_wider(names_from = "Node", values_from = "Price")
final_prices %>% filter(Node %in% c("BEN2201", "OTA2201")) %>% pivot_wider(names_from = "Node", values_from = "Price") %>% ggplot(aes(Trading_datetime, BEN2201)) + geom_point()
final_prices %>% filter(Node %in% c("BEN2201", "OTA2201")) %>% ggplot(aes(Trading_datetime, Price, colour = "Node")) + geom_point()
final_prices %>% filter(Node %in% c("BEN2201", "OTA2201")) 
final_prices %>% filter(Node %in% c("BEN2201", "OTA2201")) %>% ggplot(aes(Trading_datetime, Price, colour = Node)) + geom_point()
final_prices %>% filter(Node %in% c("BEN2201", "OTA2201")) %>% ggplot(aes(Trading_datetime, scale(Price), colour = Node)) + geom_point()
final_prices %>% filter(Node %in% c("BEN2201", "OTA2201")) %>% ggplot(aes(Trading_datetime, log10(Price), colour = Node)) + geom_point()
final_prices %>% filter(Node %in% c("BEN2201", "OTA2201")) %>% ggplot(aes(Trading_datetime, log10(Price), colour = Node)) + geom_point(alpha=0.2)
final_prices %>% filter(Node %in% c("BEN2201", "OTA2201")) 
?between
final_prices %>% filter(Node %in% c("BEN2201", "OTA2201") & between(Trading_date, ymd(20160101), ymd(20160131)))
final_prices %>% filter(Node %in% c("BEN2201", "OTA2201") & between(Trading_date, ymd(20160101), ymd(20160131))) %>% tail
x <- final_prices %>% filter(Node %in% c("BEN2201", "OTA2201") & between(Trading_date, ymd(20160101), ymd(20160131)))
ben_avg <- x %>% filter(Node == "BEN2201") %>% summarise(price = mean(Price))
ben_avg
ota_avg <- x %>% filter(Node == "OTA2201") %>% summarise(price = mean(Price))
ota_avg 
ben_prices <- x %>% filter(Node == "BEN2201") 
ota_prices <- x %>% filter(Node == "OTA2201") 
ben_prices
ota_prices
ota_ben_prices_diff <- ota_prices$Price - ben_prices$Price
ota_ben_prices_diff 
mean(ota_ben_prices_diff )
- ben_avg
ota_ben_prices_diff[ota_ben_prices_diff > 0]
mean(ota_ben_prices_diff[ota_ben_prices_diff > 0])
plot(ota_ben_prices_diff )
plot(ota_ben_prices_diff[ota_ben_prices_diff > 0])
source("ftr.R")
plot_final()
run()
plot_final()
ftrs
1 * 0.1 * 31 * 24
5 * 7 * 31 * 24
71.9 / 31
71.9 / 31 / 24
25165 / 31 / 24
25165 / 31 / 24 /7
25165 / 31 / 24 / 5
ftrs %>% filter(auction_year_month == ymd(20181201))
ftrs_2018 <- ftrs %>% filter(auction_year_month == ymd(20181201))
ftrs_2018 %>% filter(is.na(PreviousOwner))
ftrs_2018 %>% filter(!is.na(PreviousOwner))
ftrs_2018 %>% filter(Status != 'AWARDED')
skim(ftrs_2018)
ftrs_2018 <- ftrs %>% filter(between(StartDat, ymd(20181201), ymd(20181201))
)
ftrs_2018 <- ftrs %>% filter(between( StartDate, ymd(20181201), ymd(20181201) )
)
ftrs_2018 <- ftrs %>% filter(between(StartDate, ymd(20181201), ymd(20181201)))
ftrs_2018 
ftrs_2018 %>% filter(Status != 'AWARDED')
ftrs_2018 %>% filter(!is.na(PreviousOwner))
ftrs_2018 %>% filter(!is.na(PreviousOwner)) %>% count
ftrs_2018_12 <- ftrs %>% filter(between(StartDate, ymd(20181201), ymd(20181231)))
ftrs_2018_12 
ftrs_2018_12 <- ftrs %>% filter(StartDate == ymd(20181201))
ftrs_2018_12 
ftrs_2018_12  %>% ggplot(aes(DateAcquired, Price)) + geom_point()
ftrs_2018_12  %>% fitler(AuctionName == 'PRI_OCT_2016')
ftrs_2018_12  %>% filter(AuctionName == 'PRI_OCT_2016')
ftrs_2018_12  %>% filter(AuctionName == 'PRI_OCT_2016') %>% as.data.frame
ftrs_2018_12  %>% filter(AuctionName == 'PRI_OCT_2016' & Source == 'BEN' & Sink == 'OTA')
ftrs_2018_12  %>% ggplot(aes(DateAcquired, Price, colour = Source)) + geom_point()
ftrs_2018_12  %>% ggplot(aes(DateAcquired, Price, colour = Source, group = Source )) + geom_line()
ftrs_2018_12  %>% ggplot(aes(DateAcquired, Price, colour = paste(Source, Sink), group = paste(Source, Sink) )) + geom_line()
ftrs_2018_12  %>% filter(Source == 'BEN') %>% ggplot(aes(DateAcquired, Price, colour = Sink, group = Sink )) + geom_line()
ftrs_2018_12  %>% filter(Source == 'BEN') 
ftrs_2018_12  %>% filter(Source == 'BEN')  %>% group_by(AuctionName, Sink, Price) t
ftrs_2018_12  %>% filter(Source == 'BEN' & AuctionName == 'PRI_DEC_2016')
ftrs_2018_12  %>% filter(Source == 'BEN') 
ftrs_2018_12  %>% filter(Source == 'BEN' & AuctionName == 'PRI_DEC_2016')
ftrs_2018_12  %>% filter(Source == 'BEN' & AuctionName == 'PRI_DEC_2016') %>% arrange(Sink)
ftrs_2018_12  %>% filter(Source == 'BEN')  %>% group_by(AuctionName, Sink, Price)  %>% count
ftrs_2018_12  %>% filter(Source == 'BEN') %>% ggplot(aes(DateAcquired, Price, colour = Sink, group = Sink )) + geom_point()
ftrs_2018_12  %>% filter(DateAcquired > ymd(20180701)) %>% filter(Source == 'BEN') %>% ggplot(aes(DateAcquired, Price, colour = Sink, group = Sink )) + geom_point()
ftrs_2018_12  %>% filter(DateAcquired > ymd(20181001)) %>% filter(Source == 'BEN') %>% ggplot(aes(DateAcquired, Price, colour = Sink, group = Sink )) + geom_point()
ftrs_2018_12  %>% filter(DateAcquired > ymd(20181022)) %>% filter(Source == 'BEN') %>% ggplot(aes(DateAcquired, Price, colour = Sink, group = Sink )) + geom_point()
ftrs_2018_12  %>% filter(DateAcquired > ymd(20181022)) 
ftrs_2018_12  %>% filter(DateAcquired == ymd(20181023)) 
ftrs_2018_12  %>% filter(DateAcquired == ymd(20181023 & Source == 'BEN' & Sink == 'ISL')) 
ftrs_2018_12  %>% filter(DateAcquired == ymd(20181023) & Source == 'BEN' & Sink == 'ISL')) 
ftrs_2018_12  %>% filter(DateAcquired == ymd(20181023) & Source == 'BEN' & Sink == 'ISL')
ftrs_2018_12  %>% filter(Source == 'BEN' & Sink == 'ISL')
ftrs_2018_12  %>% filter(Source == 'BEN' & Sink == 'ISL') %>% arrange(CurrentOwner) 
ftrs_2018_12  %>% filter(Source == 'BEN' & Sink == 'ISL') %>% arrange(CurrentOwner)  %>% as.data.frame
ftr %>% distinct(Source)
ftrs %>% distinct(Source)
nsps        <- read_csv("../final_prices/data/20181207_NetworkSupplyPointsTable-lon-lat.csv.gz")
nsps        <- read_csv("../../final_prices/data/20181207_NetworkSupplyPointsTable-lon-lat.csv.gz")
nsps        <- read_csv("../../final_price/data/20181207_NetworkSupplyPointsTable-lon-lat.csv.gz")
nsps
names(nsps) <- make.names(names(nsps))
nspll <- nsps %>% transmute(longitude, latitude, popup = paste(NSP, Description)) %>% unique
nspll
pocsll             <- nsps %>% transmute(longitude, latitude, Description, Node = POC.code) %>% unique
pocsll
pocs
nodes
pocs <-   write_csv(pocs,  "data/pocs.csv")
cwnodespocs <- read_csv("data/pocs.csv")
pocs
?left_join
left_join(pocsll, pocs, by = c("Node" = "poc"))
pocs
inner_join(pocsll, pocs, by = c("Node" = "poc"))
nodes
nodes <- read_csv("data/nodes.csv")
nodes
pocsll
pocsll %>% mutate(Node = substr(Node, 1, 3))
pocsll <- pocsll %>% mutate(Node = substr(Node, 1, 3))
pocsll <- distinct(pocsll)
pocsll
ftrs_2018_12  %>% ggplot(aes(DateAcquired, Price, colour = paste(Source, Sink), group = paste(Source, Sink) )) + geom_line()
inner_join(pocsll, pocs, by = c("Node" = "poc"))
inner_join(pocsll, pocs, by = c("Node" = "poc"))
pocsll
poc
nodes
inner_join(pocsll, nodes, by = c("Node" = "node"))
inner_join(pocsll, nodes, by = c("Node" = "node")) %>% arrange(Node)
inner_join(pocsll, nodes, by = c("Node" = "node")) %>% arrange(Node) %>% filter(Description != 'Haywards')
nodesll <- inner_join(pocsll, nodes, by = c("Node" = "node")) %>% arrange(Node) %>% filter(Description != 'Haywards') %>% select(Node, Description, longitude, latitude)
nodesll
library(leaflet)
nodesll %>% leaflet
nodesll %>% leaflet %>% addTiles
nodesll %>% leaflet %>% addTiles %>% addMarkers
nodesll %>% leaflet %>% addTiles %>% addMarkers(popup = Node)
nodesll %>% leaflet %>% addTiles %>% addMarkers(popup = nodesll$Node)
nodesll %>% leaflet %>% addTiles %>% addMarkers(popup = nodesll$Description)
savehistory()
write_csv(nodesll, "data/nodesll.csv")
  nodesll <- read_csv("data/nodesll.csv")
  nodesll %>% leaflet %>% addTiles %>% addMarkers(popup = nodesll$Description)
source("ftr.R")
plot_map()
source("ftr.R")
plot_map()
source("ftr.R")
run()
source("ftr.R")
run 
run()
ftrs
plot_spacer()
plot_ftrs()
plot_scaled()
plot_scaled_2()
source("ftr.R")
ls_data()
ftrs
final_prices
library(zoo)
zoo::rollmean
?zoo::rollmean
final_prices %>% filter(Node == 'BEN2201') %>% zoo::rollmean(final_prices$Price, 10)
final_prices %>% filter(Node == 'BEN2201') %>% zoo::rollmean(Price, 10)
final_prices %>% filter(Node == 'BEN2201') %>% zoo::rollmean(.$Price, 10)
final_prices %>% filter(Node == 'BEN2201') %$% zoo::rollmean(.$Price, 10)
final_prices %>% filter(Node == 'BEN2201') %$% zoo::rollmean(Price, 10)
library(magrittr)
final_prices %>% filter(Node == 'BEN2201') %$% zoo::rollmean(Price, 10)
final_prices %>% filter(Node == 'BEN2201') %$% zoo::rollmean(Price, 10) %>% count
final_prices %>% filter(Node == 'BEN2201') %$% zoo::rollmean(Price, 10) %>% summary
final_prices %>% filter(Node == 'BEN2201') %$% zoo::rollmean(Price, 10) %>% skim
skim(final_prices)
final_prices %>% filter(Node == 'BEN2201') %$% zoo::rollmean(Price, 10) %>% plot
final_prices %>% filter(Node == 'BEN2201') %$% zoo::rollmean(Price, 48) %>% plot
final_prices %>% filter(Node == 'BEN2201') %$% zoo::rollmean(Price, 480) %>% plot
final_prices %>% filter(Node == 'BEN2201') %$% zoo::rollmean(Price, (30*48)) %>% plot
final_prices %>% filter(Node == 'BEN2201') %$% zoo::rollmean(Price, (365*48)) %>% plot
final_prices %>% filter(Node == 'BEN2201') %$% zoo::rollmean(Price, (365*48)) %>% skim
final_prices %>% filter(Node == 'BEN2201') 
plot_final()
run()
plot_final()
plot_final
final_node_price_differences
final_node_price_differences %>% mutate(rolling = rollmean(price_sink_source_aggr, k = 7))
final_node_price_differences %>% mutate(rolling = rollmean(price_sink_source_aggr, k = 2))
final_node_price_differences %>% mutate(rolling = rollmean(price_sink_source_aggr, k = 7, fill = NA))
x <- final_node_price_differences %>% mutate(rolling = rollmean(price_sink_source_aggr, k = 7, fill = NA)) 
plot_final
x
x %>% ggplot(aes(x = trading_month, y = price_sink_source_aggr)) + geom_line() + geom_line(aes(y = rolling), colour = 'green')
x
x %>% ggplot(aes(x = trading_month, y = price_sink_source_aggr)) + geom_line() 
x
x %>% ggplot(aes(x = trading_month, y = price_sink_source_aggr)) + geom_line() 
x %>% ggplot(aes(x = trading_month, y = price_sink_source_aggr)) + geom_line() + geom_line(aes(y = rolling), colour = 'green')
x %>% ggplot(aes(x = trading_month, y = price_sink_source_aggr)) + geom_line() + geom_line(aes(y = rolling), colour = 'green')
plot_scaled()
plot_scaled2()
plot_scaled_2()
plot_scaled_2()
all_years()
all_years()
  ftrs_src_snk_year  <- ftrs %>% filter(Source == source_node & Sink == sink_node)
  final_src_snk_year <- final_prices %>% filter(Node %in% c(source_node_poc, sink_node_poc))
  final_node_price_differences <- create_final_node_price_differences(final_src_snk_year)
ftrs_src_snk_year  
  ftrs_src_snk_year  %>%
    ggplot(aes(DateAcquired, Price, colour = factor(year(StartDate)))) +
      geom_point() +
ads
  ftrs_src_snk_year  %>%
    ggplot(aes(DateAcquired, Price, colour = factor(year(StartDate)))) + geom_point()
final_node_price_differences
  ftrs_src_snk_year  %>%
    ggplot(aes(DateAcquired, Price, colour = factor(year(StartDate)))) +
      geom_point() +
      geom_line(data = final_node_price_differences, aes(x = trading_month, y = price_sink_source_aggr), colour = "black")
all_years()
x <- final_node_price_differences %>% mutate(rolling = rollmean(price_sink_source_aggr, k = 7, fill = NA)) 
source("ftr.R")
ls()
ls_data()
final_node_price_differences
source("ftr.R")
plot_final()
plot_final()
  temp <- ftrs_src_snk_year %>% group_by(DateAcquired, StartDate) %>%
                                summarise(price_aggr = mean(Price)) %>%
                                ungroup
  temp %>% ggplot(aes(DateAcquired, scale(price_aggr), colour = factor(StartDate))) +
             geom_line(stat = 'smooth', alpha = 0.4, se = FALSE) +
             geom_line(data = temp, aes(DateAcquired, scale(price_aggr)), stat = 'smooth', colour = "black" ) +
             geom_line(data = final_node_price_differences, aes(trading_month, scale(price_sink_source_rolling)), colour = "red")
  temp <- ftrs_src_snk_year %>% group_by(DateAcquired, StartDate) %>%
                                summarise(price_aggr = mean(Price)) %>%
                                ungroup
  temp %>% ggplot(aes(DateAcquired, scale(price_aggr), colour = factor(StartDate))) +
             geom_line(stat = 'smooth', alpha = 0.4, se = FALSE) +
             geom_line(data = temp, aes(DateAcquired, scale(price_aggr)), stat = 'smooth', colour = "black" ) +
             geom_line(data = final_node_price_differences, aes(trading_month, scale(price_sink_source_rolling)), colour = "red")
  temp %>% ggplot(aes(DateAcquired, scale(price_aggr), colour = factor(StartDate))) +
             geom_line(stat = 'smooth', alpha = 0.4, se = FALSE) +
             geom_line(data = final_node_price_differences, aes(trading_month, scale(price_sink_source_rolling)), colour = "red")
final_node_price_differences 
final_node_price_differences  %>% filter(trading_month >= ymd(20180101))
x <- final_node_price_differences  %>% filter(trading_month >= ymd(20180101))
  temp %>% ggplot(aes(DateAcquired, scale(price_aggr), colour = factor(StartDate))) +
             geom_line(stat = 'smooth', alpha = 0.4, se = FALSE) +
             geom_line(data = x, aes(trading_month, scale(price_sink_source_rolling)), colour = "red")
  temp %>% ggplot(aes(DateAcquired, scale(price_aggr), colour = factor(StartDate))) +
             geom_line(stat = 'smooth', alpha = 0.4, se = FALSE) +
             geom_line(data = x, aes(trading_month, scale(price_sink_source_rolling)), colour = "red")
.Last.value
.Last.value + theme(legend.title = element_blank())
x
x %>% mutate(trading_month = months(6))
x %>% mutate(trading_month = trading_month + months(6))
x 
x %>% mutate(trading_month = trading_month + months(5))
x <- x %>% mutate(trading_month_plus = trading_month + months(5))
x
temp %>% ggplot(aes(DateAcquired, scale(price_aggr), colour = factor(StartDate))) + geom_line(stat = 'smooth', alpha = 0.4, se = FALSE) +
geom_line(data = x, aes(trading_month_plus, scale(price_sink_source_rolling)), colour = "red")
plot_scaled <- function() {
  temp <- ftrs_src_snk_year %>% group_by(DateAcquired, StartDate) %>%
                                summarise(price_aggr = mean(Price)) %>%
                                ungroup
  temp %>% ggplot(aes(DateAcquired, scale(price_aggr), colour = factor(StartDate))) +
             geom_line(stat = 'smooth', alpha = 0.4, se = FALSE) +
             geom_line(data = temp, aes(DateAcquired, scale(price_aggr)), stat = 'smooth', colour = "black" ) +
             geom_line(data = final_node_price_differences, aes(trading_month, scale(price_sink_source_rolling)), colour = "red")
}
plot_scaled()
x
temp %>% ggplot(aes(DateAcquired, scale(price_aggr), colour = factor(StartDate))) + geom_line(stat = 'smooth', alpha = 0.4, se = FALSE) +
geom_line(data = temp, aes(DateAcquired, scale(price_aggr)), stat = 'smooth', colour = "black" ) +
geom_line(data = x, aes(trading_month_plus, scale(price_sink_source_rolling)), colour = "red")
temp %>% ggplot(aes(DateAcquired, scale(price_aggr), colour = factor(StartDate))) + geom_line(stat = 'smooth', alpha = 0.4, se = FALSE) +
geom_line(data = temp, aes(DateAcquired, scale(price_aggr)), stat = 'smooth', colour = "black" ) +
geom_line(data = x, aes(trading_month, scale(price_sink_source_rolling)), colour = "red")
source("ftr.R")
ftrs
ftrs %>% distinct(CurrentOwner)
source("ftr.R") 
plot_scaled()
plot_scaled
x <- final_node_price_differences %>% mutate(rolling = rollmean(price_sink_source_aggr, k = 7, fill = NA)) 
final_node_price_differences
plot_final
plot_final()
plot_final()
source("../hedge-discolsure.R")
ls_data()
plot_final()
plot_final
final_node_price_differences %>% ggplot(aes(x = trading_month, y = price_sink_source_rolling)) + geom_line()
final_node_price_differences %>% ggplot(aes(x = trading_month, y = price_sink_source_rolling)) + geom_line()
final_node_price_differences 
library(shiny) ; runApp()
library(shiny) ; runApp()
library(shiny) ; runApp()
library(shiny) ; runApp()
library(shiny) ; runApp()
as.integer("2019")
library(shiny) ; runApp()
library(shiny) ; runApp()
library(shiny) ; runApp()
library(shiny) ; runApp()
library(shiny) ; runApp()
library(shiny) ; runApp()
x <- 1
print("{x}")
glue("{x}")
str_glue("{x}")
library(shiny) ; runApp()
library(shiny) ; runApp()
library(shiny) ; runApp()
library(shiny) ; runApp()
library(shiny) ; runApp()
library(shiny) ; runApp()
library(shiny) ; runApp()
library(shiny) ; runApp()
library(shiny) ; runApp()
library(shiny) ; runApp()
library(shiny) ; runApp()
library(shiny) ; runApp()
library(shiny) ; runApp()
library(shiny) ; runApp()
library(shiny) ; runApp()
library(shiny) ; runApp()
library(shiny) ; runApp()
library(shiny) ; runApp(launch.browser=F)
library(shiny) ; runApp(launch.browser=F)
library(shiny) ; runApp(launch.browser=F)
library(shiny) ; runApp(launch.browser=F)
library(shiny) ; runApp(launch.browser=F)
library(shiny) ; runApp(launch.browser=T)
library(shiny) ; runApp(launch.browser=F)
library(shiny) ; runApp(launch.browser=F)
library(shiny) ; runApp(launch.browser=F)
library(shiny) ; runApp(launch.browser=F)
library(shiny) ; runApp(launch.browser=F)
library(shiny) ; runApp(launch.browser=F)
library(shiny) ; runApp(launch.browser=F)
library(shiny) ; runApp(launch.browser=F)
library(shiny) ; runApp(launch.browser=F)
library(shiny) ; runApp(launch.browser=F)
library(shiny) ; runApp(launch.browser=T)
library(shiny) ; runApp(launch.browser=T)
library(shiny) ; runApp(launch.browser=T)
library(shiny) ; runApp(launch.browser=T)
library(shiny) ; runApp(launch.browser=T)
library(shiny) ; runApp(launch.browser=T)
library(shiny) ; runApp(launch.browser=F)
library(shiny) ; runApp(launch.browser=F)
